<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script> 
    <script src="/static/js/react.development.min.js"></script>
    <script src="/static/js/react-dom.development.min.js"></script>
    <script src="/static/js/babel.min.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game</title>
    <style>
        .incorrect{
            color:red;
        }
        body{
            text-align: center;
            background-color: lightgrey;
        }
        .score .input{
            font-size:20px;
        }

        .values{
            font-size:40px;
        }
        #res{
            width:20%;
        }

    </style>
</head>
<body>
    <div id="app"></div>
    <script type="text/babel">

        class App extends React.Component{
            constructor(props){
                super(props);
                this.state={
                    score:0,
                    num1:0,
                    num2:0,
                    response:"",
                    incorrect:false,
                    winScore:""
                };

            }

            render(){
                if(this.state.score=== parseInt(this.state.winScore)){
                    return this.renderWin();
                }
                else{
                    return this.renderProblem();
                }
            }

            renderWin(){
                return(
                    <div>
                        <h1>Congratulations! You Win</h1>
                        <button onClick={() => window.location.reload()}>Click here</button>
                    </div>
                );
            }

            renderProblem(){
                return(
                    <div>
                        <h1>Addition Game</h1>
                        <hr></hr>
                        <div className="input">
                            <p>
                            <label>Target score setup</label><br></br><br></br>
                            <input placeholder="enter score to win" onChange={this.winScoreUpdate} value={this.state.winScore}/>
                        </p>
                        </div>
                        <div className="score">
                            <p>Target score to win: {this.state.winScore}</p>
                        </div>
                        <div className="values">
                        <p className={this.state.incorrect ? "incorrect":""}>{this.state.num1} + {this.state.num2}</p>
                    <input id="res" onKeyPress={this.inputKeyPress} onChange={this.UpdateResponse} value={this.state.response}/>
                        </div>
                        <div>Score:{this.state.score}</div>
                    </div>
                );
            }

            winScoreUpdate = (event)=>{
                this.setState({
                    winScore: event.target.value
                });

            }

            UpdateResponse = (event) =>{
                this.setState({
                    response: event.target.value
                });
            }

            inputKeyPress = (event) =>{

                if(event.key === "Enter"){
                    // correct answer..
                    const answer = parseInt(this.state.response);
                    if(answer === this.state.num1 + this.state.num2){
                        this.setState(state =>({
                            score : state.score + 1,
                            response:"",
                            num1: Math.floor(Math.random() * 10),
                            num2: Math.floor(Math.random() * 10),
                            incorrect : false
                        }));

                    }
                    else{
                        //wrong answer..
                        this.setState(state => ({
                            response:"",
                            score:state.score - 1,
                            incorrect: true
                        }));

                    }
                }

            }

        }

        ReactDOM.render(<App/>,document.querySelector("#app"));

    </script>
    
</body>
</html>